(self.webpackChunklite=self.webpackChunklite||[]).push([[1969],{14856:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(67294);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=r.createElement("rect",{x:26.25,y:9.25,width:.5,height:6.5,rx:.25,strokeWidth:.5}),s=r.createElement("rect",{x:29.75,y:12.25,width:.5,height:6.5,rx:.25,transform:"rotate(90 29.75 12.25)",strokeWidth:.5}),u=r.createElement("path",{d:"M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5",strokeLinecap:"round"}),o=r.createElement("path",{d:"M11.5 14.5L19 20l4-3",strokeLinecap:"round"});const a=function(e){return r.createElement("svg",i({width:38,height:38,viewBox:"0 0 38 38",fill:"none"},e),l,s,u,o)}},90194:(e,t,n)=>{"use strict";n.d(t,{w:()=>a});var r=n(67294),i=n(55099),l=n(42933),s=n(77180),u=n(6688),o=n(14856),a=function(e){var t,n=e.buttonSize,a=void 0===n?"LARGE":n,c=e.buttonStyle,d=void 0===c?"STRONG":c,b=e.showMailIcon,w=void 0===b||b,v=e.onClick,m=e.width,f=e.buttonText,g=void 0===f?"Get this newsletter":f,E=e.redirectUrl,S=e.displayOnly,p=void 0!==S&&S,y=(0,s.F)(),h=(0,u.I)();return r.createElement(i.z,{buttonStyle:d,onClick:v,size:a,width:m,padding:"0 8px",href:E,displayOnly:p},r.createElement(l.x,{paddingRight:"8px",justifyContent:"center",alignItems:"center"},w&&r.createElement("span",{className:h((t=y.accentColor.background,{stroke:t})),"aria-hidden":"true"},r.createElement(o.Z,null)),g))}},11969:(e,t,n)=>{"use strict";n.d(t,{B:()=>R,x:()=>k});var r=n(67154),i=n.n(r),l=n(63038),s=n.n(l),u=n(28655),o=n.n(u),a=n(71439),c=n(67294),d=n(90194),b=n(99033),w=n(76532),v=n(62181),m=n(42933),f=n(92528),g=n(41707),E=n(1072),S=n(55099),p=n(82318),y=n(66266),h=n(98024),V=n(51512),C=n(14391),N=n(85277),O=n(8403),T=n(67297),I=n(51064),_=n(27952),x=n(534);function P(){var e=o()(["\n  fragment NewsletterV3SubscribeButton_newsletterV3 on NewsletterV3 {\n    id\n    name\n    slug\n    type\n    user {\n      id\n      name\n      username\n    }\n    collection {\n      slug\n      ...SusiClickable_collection\n      ...collectionDefaultBackgroundTheme_collection\n    }\n    ...SusiClickable_newsletterV3\n  }\n  ","\n  ","\n  ","\n"]);return P=function(){return e},e}var R=(0,a.Ps)(P(),v.Os,v.GB,x.Gi),k=function(e){var t,n,r,l,u=e.newsletterV3,o=e.buttonLayout,a=void 0===o?"MULTI-LINE":o,P=e.helperTextColor,R=void 0===P?"LIGHTER":P,k=e.showHelperText,L=void 0===k||k,A=e.showMailIcon,B=void 0===A||A,M=e.buttonSize,U=void 0===M?"LARGE":M,$=e.buttonStyle,j=void 0===$?"STRONG":$,G=e.redirectUrl,z=e.buttonText,D=e.width,F=(0,w.H)().value,W=u.id,Q=u.collection?u.collection:void 0,Y=u.user?u.user:void 0,q=(0,N.w)(),H=(0,O.PM)(),Z=(0,T.v9)((function(e){return e.config.productName})),J=(0,I.O)(!1),X=s()(J,3),K=X[0],ee=X[1],te=X[2];switch(u.type){case C.Rr.NEWSLETTER_TYPE_COLLECTION:t=u.name,n="Get this newsletter",r="You’re signed up for ".concat(t,"."),l="newsletter_v3_promo";break;case C.Rr.NEWSLETTER_TYPE_AUTHOR:t=null==Y?void 0:Y.name,n="Subscribe",r="You’re subscribed to ".concat(t),l="subscribe_user"}var ne=(0,b.oT)({newsletterV3:u,newsletterName:t}),re=ne.isSubscribed,ie=ne.hasError,le=ne.setSubscribe;c.useEffect((function(){if(H){var e=(0,V.P7)(H||"").susiEntry;["collection_newsletter_v3_landing","newsletter_v3_promo"].includes(void 0===e?"":e)&&re&&q({duration:"NEXTPAGE",message:"",toastStyle:"NEWSLETTER_SUBSCRIBE",extraParams:{newsletterName:t,newsletterType:u.type,unsubscribeFn:function(){return le(!1)}}})}}),[H,re]);var se=function(e){var t=e.children;return c.createElement(m.x,{margin:"COMPACT"===a?"10px 20px 10px 0":"",xs:{margin:"10px 0 0 0"}},t)},ue=function(e){var t=e.children;return c.createElement(m.x,{maxWidth:"COMPACT"===a?"380px":"",margin:"COMPACT"===a?"10px 0 10px 0":"10px 0 0 0"},c.createElement(h.F,{scale:"S",color:R},t))},oe=function(){var e=(0,_.Zul)(W),r={buttonSize:U,buttonStyle:j,onClick:function(){F&&(F&&F.allowEmailAddressSharingEditorWriter?le(!0,!1):ee())},showMailIcon:B,buttonText:z||n,redirectUrl:G,width:D};return c.createElement(se,null,F?c.createElement(c.Fragment,null,c.createElement(d.w,r),c.createElement(f.Q,{onConfirm:function(){return le(!0,!0)},isVisible:K,hide:te,titleText:"Confirm your subscription to ".concat(t),confirmText:"Confirm now",buttonStyle:"STRONG",buttonSize:"LARGE",showCancelButton:!1,withCloseButton:!1,isDestructiveAction:!1},"By confirming, you agree to share your email address with the editors of newsletters and writers you've subscribed to so they can stay in contact with you outside of ".concat(Z,". You can opt out of sharing your email address by unsubscribing in your Settings."))):c.createElement(v.R9,{operation:"register",newsletterV3:u,user:Y,collection:Q,actionUrl:e,susiEntry:l,redirectTo:G},c.createElement(d.w,i()({},r,{redirectUrl:void 0}))))};return c.createElement(c.Fragment,null,c.createElement(g.Z,null,(function(e){return c.createElement(E.f,{theme:(0,x.jN)(Q,e)},re?c.createElement(c.Fragment,null,c.createElement(se,null,c.createElement(S.z,{buttonStyle:"SUBTLE",size:"SMALL",onClick:function(){return le(!1)}},"Unsubscribe")),L&&c.createElement(ue,null,r)):c.createElement(V.cW,{source:{newsletterV3Id:u.id},extendSource:!0},c.createElement(oe,null),L&&F&&c.createElement(ue,null,"Emails will be sent to ",F.email,".",c.createElement(v.R9,{operation:"login",newsletterV3:u,collection:Q,susiEntry:l},c.createElement(p.r,{display:"block",onClick:function(){},linkStyle:"OBVIOUS",inline:!0,target:"_blank"},"Not you?")))))})),ie&&c.createElement(y.F,{toastStyle:"RETRYABLE_ERROR",isVisible:ie,hide:function(){}}))}},99033:(e,t,n)=>{"use strict";n.d(t,{oT:()=>k});var r=n(59713),i=n.n(r),l=n(63038),s=n.n(l),u=n(28655),o=n.n(u),a=n(82492),c=n.n(a),d=n(71439),b=n(46829),w=n(67294),v=n(53976),m=n(81474),f=n(32589),g=n(95760),E=n(51512),S=n(85277);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(){var e=o()(["\n  mutation fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe(\n    $userId: ID!\n    $shouldSubscribeCurrentUser: Boolean\n  ) {\n    fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe(\n      userId: $userId\n      shouldSubscribeCurrentUser: $shouldSubscribeCurrentUser\n    ) {\n      __typename\n      ...useNewsletterV3Subscription_newsletterV3\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function V(){var e=o()(["\n  mutation unsubscribeNewsletterV3($newsletterV3Id: ID!) {\n    unsubscribeNewsletterV3(newsletterV3Id: $newsletterV3Id)\n  }\n"]);return V=function(){return e},e}function C(){var e=o()(["\n  mutation subscribeNewsletterV3($newsletterV3Id: ID!, $shouldRecordConsent: Boolean) {\n    subscribeNewsletterV3(\n      newsletterV3Id: $newsletterV3Id\n      shouldRecordConsent: $shouldRecordConsent\n    )\n  }\n"]);return C=function(){return e},e}function N(){var e=o()(["\n  fragment useNewsletterV3Subscription_newsletterV3_viewerEdge on NewsletterV3 {\n    viewerEdge {\n      id\n      isSubscribed\n    }\n  }\n"]);return N=function(){return e},e}function O(){var e=o()(["\n  fragment useNewsletterV3Subscription_user on User {\n    id\n    newsletterV3 {\n      ...useNewsletterV3Subscription_newsletterV3\n    }\n  }\n  ","\n"]);return O=function(){return e},e}function T(){var e=o()(["\n  fragment useNewsletterV3Subscription_newsletterV3 on NewsletterV3 {\n    id\n    type\n    slug\n    name\n    collection {\n      slug\n    }\n    user {\n      id\n      name\n      username\n    }\n  }\n"]);return T=function(){return e},e}var I=(0,d.Ps)(T()),_=(0,d.Ps)(O(),I),x=((0,d.Ps)(N()),(0,d.Ps)(C())),P=(0,d.Ps)(V()),R=(0,d.Ps)(h(),I),k=function(e){var t=e.newsletterV3,n=e.creator,r=e.newsletterName,i=t||{},l=i.id,u=i.type,o=i.slug,a=i.collection,d=i.user,p=null!=r?r:null==t?void 0:t.name,h=w.useState(!1),V=s()(h,2),C=V[0],N=V[1],O=(0,m.T)({newsletterSlug:o,collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username}),T=O.viewerEdge,I=O.loading,k=(0,v.VB)({name:"enable_auto_follow_on_subscribe",placeholder:!1}),L=w.useState(!1),A=s()(L,2),B=A[0],M=A[1];w.useEffect((function(){M(!(null==T||!T.isSubscribed))}),[null==T?void 0:T.isSubscribed]);var U=(0,g.Av)(),$=(0,E.Qi)(),j=(0,S.w)();C&&U.event("newsletterV3.subscribe.error",{newsletterV3Id:l});var G=function(e,t,r){if(r){var i={id:null==n?void 0:n.id,fragment:_,fragmentName:"useNewsletterV3Subscription_user"},l=e.readFragment(i);e.writeFragment(y(y({},i),{},{data:y(y({},l),{},{newsletterV3:r})}))}var s=e.readQuery({query:m.p,variables:{newsletterSlug:o,collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username}}),u=c()({},s,{newsletterV3:{viewerEdge:{isSubscribed:t}}});if(e.writeQuery({query:m.p,variables:{newsletterSlug:o||"",collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username},data:u}),t&&k){var b=e.readQuery({query:f.J4,variables:{userId:null==d?void 0:d.id}}),w=c()({},b,{user:{viewerEdge:{isFollowing:!0}}});e.writeQuery({query:f.J4,variables:{userId:(null==d?void 0:d.id)||""},data:w})}},z=(0,b.useMutation)(x,{onCompleted:function(e){var t=e.subscribeNewsletterV3;N(!t),t&&(U.event("newsletterV3.subscribeClicked",{newsletterV3Id:l,source:$}),M(!0))},update:function(e){G(e,!0)}}),D=s()(z,1)[0],F=(0,b.useMutation)(P,{onCompleted:function(e){var t=e.unsubscribeNewsletterV3;N(!t),t&&(M(!1),j({duration:"NEXTPAGE",message:"",toastStyle:"NEWSLETTER_UNSUBSCRIBE",extraParams:{newsletterName:p||null,newsletterType:u||null,unsubscribeFn:function(){return M(!1)}}}))},update:function(e){G(e,!1)}}),W=s()(F,1)[0],Q=(0,b.useMutation)(R,{onCompleted:function(e){var t=e.fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe;N(!t);var n=y({},t);t&&(U.event("newsletterV3.subscribeClicked",{newsletterV3Id:n.id,source:$}),M(!0))},update:function(e,t){var n,r=y({},null===(n=t.data)||void 0===n?void 0:n.fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe);G(e,!0,r)}}),Y=s()(Q,1)[0];return{isSubscribed:B,hasError:C,setSubscribe:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];N(!1),e&&!t&&null!=n&&n.id?Y({variables:{userId:null==n?void 0:n.id,shouldSubscribeCurrentUser:!0}}):e&&null!=t&&t.id?D({variables:{newsletterV3Id:null==t?void 0:t.id,shouldRecordConsent:r}}):null!=t&&t.id?W({variables:{newsletterV3Id:null==t?void 0:t.id}}):N(!0)},loading:I}}},81474:(e,t,n)=>{"use strict";n.d(t,{T:()=>o,p:()=>a});var r=n(28655),i=n.n(r),l=n(46829),s=n(71439);function u(){var e=i()(["\n  query NewsletterV3ViewerEdge($newsletterSlug: ID!, $collectionSlug: ID, $username: ID) {\n    newsletterV3(\n      newsletterSlug: $newsletterSlug\n      collectionSlug: $collectionSlug\n      username: $username\n    ) {\n      ... on NewsletterV3 {\n        id\n        viewerEdge {\n          id\n          isSubscribed\n        }\n      }\n    }\n  }\n"]);return u=function(){return e},e}var o=function(e){var t,n=e.newsletterSlug,r=void 0===n?"":n,i=e.collectionSlug,s=e.username,u=(0,l.useQuery)(a,{variables:{newsletterSlug:r,collectionSlug:i,username:s},ssr:!1,skip:!r}),o=u.loading,c=u.error,d=u.data;return o?{loading:o}:c?{error:c}:{viewerEdge:null==d||null===(t=d.newsletterV3)||void 0===t?void 0:t.viewerEdge}},a=(0,s.Ps)(u())}}]);
//# sourceMappingURL=https://stats.medium.build/lite/sourcemaps/1969.1fbf6133.chunk.js.map